version: "3"
services:
  hv:
    image: ghcr.io/cdozen/dummy:0.0.1
    links:
      - mosquitto
    command: ['python', 'dummy/hv.py', 'hv', 'mosquitto']
  lv:
    image: ghcr.io/cdozen/dummy:0.0.1
    links:
      - mosquitto
    command: ['python', 'dummy/hv.py', 'lv', 'mosquitto']
  sensor_1:
    image: ghcr.io/cdozen/dummy:0.0.1
    links:
      - mosquitto
    command: ['python', 'dummy/sensor.py', 'sensor_1', 'mosquitto']
  
  low_voltage:
    image: ghcr.io/cdozen/low_voltage:0.0.1
    links:
      - mosquitto
    command: ['python3', 'hmp.py', 'lw_volt', 'mosquitto']
  
  #web_server:
  #  image: ghcr.io/cdozen/tracker_dcs_web:0.0.1
  #  restart: always
  #  stdin_open: true
  #  tty: true
    # port must be open even in production as it's a webserver open to outside
    # TODO: setup authentication
  #  environment:
  #    - APP_USER=cdozen
  #    - APP_PASSWORD=test
  #  ports:
  #    - "8001:8000"
  #  expose:
  #    - "8001"
  #  links:
  #    - mosquitto
    #command: ['python3', 'web_server/app.py', 'web_server','mosquitto']
    #command: ["uvicorn", "web_server.app:app", "--host", "0.0.0.0"]
    #command: ["uvicorn", "web_server.app_test:app", "--host", "0.0.0.0"]
  
 


